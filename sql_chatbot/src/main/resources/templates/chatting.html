<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Chat</title>
	<th:block th:insert="~{include.html}" />
</head>
<body>
<th:block th:insert="~{header.html}" />
<div class="container-fluid h-100">
	<div class="row justify-content-center h-100">
		<div class="col-md-4 col-xl-3 chat"><div class="card mb-sm-3 mb-md-0 contacts_card">
			<div class="card-header">
				<h4 style="text-align:center; color:white;">Your databases</h4>
			</div>
			<div class="card-body contacts_body">
				<ui class="contacts">
					<li th:each="database : ${databases}" th:classappend="${selectedDatabase?.id==database.id} ? active">
						<form th:id="${database?.id}" method="POST" th:action="@{'/chat/selectDatabase'}">
							<input type="hidden" name="databaseId" th:value="${database.id}">
							<a href="#" onclick="this.parentNode.submit()">
								<div class="d-flex bd-highlight">
									<div class="user_info">
										<span th:value="${database.name}" th:text="${database.name}"></span>
										<p th:value="${database.databaseName}" th:text="${database.databaseName}"></p>
									</div>
								</div>
							</a>
						</form>
					</li>
				</ui>
			</div>
			<div class="card-footer">
				<div style="text-align: center;">
					<a href="/add_database" style="text-align: center; color: white">
						<div class="user_info" style="background: #0000006b; border: #0000006b; border-radius: 10px;">
							<span>Add a New Database?</span>
						</div>
					</a>
				</div>
			</div>
		</div></div>
		<div class="col-md-8 col-xl-6 chat">
			<div class="card">
				<h1 th:unless="${selectedDatabase}" style="color: white; margin: auto; text-align: center;">Well what are you waiting for? Select or add a database to chat!</h1>
				<div class="card-header msg_head" th:if="${selectedDatabase}">
					<div class="d-flex bd-highlight">
						<div class="user_info">
							<span th:text="${selectedDatabase?.getName()}"></span>
						</div>
					</div>
					<span id="action_menu_btn" th:if="${selectedDatabase}"><i class="fas fa-ellipsis-v"></i></span>
					<div class="action_menu">
						<ul>
							<a th:href="@{'/edit_database'}">
								<li><i class="fas fa-user-circle"></i>Edit the Database</li>
							</a>
							<form class="form-inline" th:method="POST" th:action="@{'/delete_database/{id}' (id=${selectedDatabase?.id})}">
								<a href="#" onclick="this.parentNode.submit()">
									<li style="color: red;"><i class="fas fa-ban"></i>Delete the Database?</li>
								</a>
							</form>
						</ul>
					</div>
				</div>
				<div class="scrollable" style="overflow:auto;" th:classappend="${selectedDatabase} ? 'theMaxHeight'">
					<h1 th:if="${selectedDatabase} and ${isQuestions}" style="text-align: center;color: white;" class="first_message">Type in your first question!</h1>
						<div class="card-body msg_card_body">
							<div class="the_messages" th:each="question, index : ${questions}" th:id="'question_' + ${index}">
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send" th:text="${question.getQuestionText()}"></div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="msg_cotainer" th:text="${question.getQuestionAnswer()}" th:classappend="${firstAnswer != null and lastQuestion == question} ? animated"></div>
								</div>
							</div>
						</div>
				</div>
				<div class="card-footer" style="position: sticky;bottom: 0;width: 100%;" th:if="${selectedDatabase}">
					<form class="input-group" th:action="@{'/ask_question'}" method="post">
						<input id="question" name="question" class="form-control type_msg" placeholder="Type your message..."></input>
						<div class="input-group-append" onclick="animateAndSubmit()">
							<span class="input-group-text send_btn"><i class="fas fa-location-arrow"></i></span>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.usebootstrap.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="/js/scripts.js"></script>
</body>
</html>

